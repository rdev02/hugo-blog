<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.70.0 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Viktor Halitsyn">
<meta name="keywords" content=", code, travel, immigration, ukraine, washington">
<meta name="description" content="Recently i was developing a feature for the Adobe(R) Acrobat Reader(R) plugin and come across an issue of selecting/highlighting annotations on the document based on some criteria e.g. if an annotation is positioned too close to the margin of the page… – bad you are :). Here i’ll post a tutorial like code for atchieving this goal for when trying to resolve that problem the only helpful information i foud was the Adobe Acrobat 7.">


<meta property="og:description" content="Recently i was developing a feature for the Adobe(R) Acrobat Reader(R) plugin and come across an issue of selecting/highlighting annotations on the document based on some criteria e.g. if an annotation is positioned too close to the margin of the page… – bad you are :). Here i’ll post a tutorial like code for atchieving this goal for when trying to resolve that problem the only helpful information i foud was the Adobe Acrobat 7.">
<meta property="og:type" content="article">
<meta property="og:title" content="Custom selection server in PDF plugin">
<meta name="twitter:title" content="Custom selection server in PDF plugin">
<meta property="og:url" content="http://blog.vnomad.com/code/custom-selection-server-in-pdf-plugin/">
<meta property="twitter:url" content="http://blog.vnomad.com/code/custom-selection-server-in-pdf-plugin/">
<meta property="og:site_name" content="Nomad&#39;s reflections">
<meta property="og:description" content="Recently i was developing a feature for the Adobe(R) Acrobat Reader(R) plugin and come across an issue of selecting/highlighting annotations on the document based on some criteria e.g. if an annotation is positioned too close to the margin of the page… – bad you are :). Here i’ll post a tutorial like code for atchieving this goal for when trying to resolve that problem the only helpful information i foud was the Adobe Acrobat 7.">
<meta name="twitter:description" content="Recently i was developing a feature for the Adobe(R) Acrobat Reader(R) plugin and come across an issue of selecting/highlighting annotations on the document based on some criteria e.g. if an annotation is positioned too close to the margin of the page… – bad you are :). Here i’ll post a tutorial like code for atchieving this goal for when trying to resolve that problem the only helpful information i foud was the Adobe Acrobat 7.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2007-10-19T14:21:00">
  
  
    <meta property="article:modified_time" content="2007-10-19T14:21:00">
  
  
  
    
      <meta property="article:section" content="tech">
    
  
  
    
      <meta property="article:tag" content="c&#43;&#43;">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@rdev02">


  <meta name="twitter:creator" content="@rdev02">










  <meta property="og:image" content="https://www.gravatar.com/avatar/d96a6dd84105118027bb67e3396ba7e4?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/d96a6dd84105118027bb67e3396ba7e4?s=640">


    <title>Custom selection server in PDF plugin</title>

    <link rel="icon" href="/favicon.jpg">
    

    
      <link rel="publisher" href="https://plus.google.com/&#43;victorhalitsyn">
    

    <link rel="canonical" href="http://blog.vnomad.com/code/custom-selection-server-in-pdf-plugin/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://fonts.googleapis.com/css?family=Oswald|Roboto">
      
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-64535001-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="3">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">Nomad&#39;s reflections</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="3">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/d96a6dd84105118027bb67e3396ba7e4?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Viktor Halitsyn</h4>
        
          <h5 class="sidebar-profile-bio">Came a long way from Ukraine, still so much to go&hellip;</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i style="color:black" class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i style="color:black" class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/tags">
    
      <i style="color:black" class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives">
    
      <i style="color:black" class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/#about">
    
      <i style="color:black" class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/rdev02" target="_blank" rel="noopener">
    
      <i style="color:black" class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/rdev02" target="_blank" rel="noopener">
    
      <i style="color:black" class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml">
    
      <i style="color:black" class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="3"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Custom selection server in PDF plugin
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2007-10-19T14:21:00Z">
        
  
  
  
  
    10/19/2007
  

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="/categories/tech">tech</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>Recently i was developing a feature for the Adobe(R) Acrobat Reader(R) plugin and come across an issue of selecting/highlighting annotations on the document based on some criteria e.g. if an annotation is positioned too close to the margin of the page… – bad you are :). Here i’ll post a tutorial like code for atchieving this goal for when trying to resolve that problem the only helpful information i foud was the Adobe Acrobat 7.0.5 SDK.First i would like to say that i haven’t found better way(say another way) to make slection/highlight of an annotation that creating my own selection server for that annotation. It also has to be said that every single type in Acrobat that “can be highlighted” has its own selection server(of type AVDocSelectionServer) which in practise can be obtained if you know its “internal” name. For example if you want a selection server for type “Button” you can something as following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">AVDocGetSelectionServerByType(ASAtomFromString(<span style="color:#e6db74">&#34;Button&#34;</span>));
</code></pre></div><p>There are selection servers for simple annotations but my annotation was a custom object, created by plug-in and thus didn’t have one. It didn’t prevent acrobat to use normal highlighting for it as when treating it as simple annotation in object editing mode, but the request was to provide highligting regardless of mode. So solution is to register the selection server. There is an example shipped with SDK of how to make custom selection servers but this example has a minor bug in it(it is configured so that selection will be drawn on every page whereas it has to be drawn only on the page where the object resides) and it doesnt take into consideration possibility of acrobat to change selection servers without notifying current selection server to lose its selection(for example when user press CTRL+A). So here we go with the code:First thing is to create a class which would be holding our selection and provide the selection type. To manage selections on different pages i created a simple class containinng list with page/data pairs and made it static for cross-page persistance. secondly implement the selection server. There is one workaround here in my code: to handle CTRL+A for simple objects on the page i use its selection server by injecting “losing selection” funtionality before server case takes place and then return to the normal application flow.This is definetely not a good way – but i found no other solution and this one is working:).</p>
<p>So here is the header file of the Selection Server</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">/*********************************************************************
</span><span style="color:#75715e">ADOBE SYSTEMS INCORPORATED
</span><span style="color:#75715e">Copyright (C) 1994-2003 Adobe Systems Incorporated
</span><span style="color:#75715e">All rights reserved.
</span><span style="color:#75715e">NOTICE: Adobe permits you to use, modify, and distribute this file
</span><span style="color:#75715e">in accordance with the terms of the Adobe license agreement
</span><span style="color:#75715e">accompanying it. If you have received this file from a source other
</span><span style="color:#75715e">than Adobe, then your use, modification, or distribution of it
</span><span style="color:#75715e">requires the prior written permission of Adobe.
</span><span style="color:#75715e">---------------------------------------------------------------------
</span><span style="color:#75715e">SelectionServer.h
</span><span style="color:#75715e">*********************************************************************/</span>

<span style="color:#75715e">#ifndef PIDGETSELECTIONSERVER_H
</span><span style="color:#75715e">#define PIDGETSELECTIONSERVER_H
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;list&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;map&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">typedef</span> pair<span style="color:#f92672">&lt;</span>pdpage,list<span style="color:#f92672">&lt;</span>asfixedRect<span style="color:#f92672">&gt;*&gt;</span> PageSelection;
  <span style="color:#75715e">/* CustomClassSelection
</span><span style="color:#75715e">  ** ------------------------------------------------------
</span><span style="color:#75715e">  **
</span><span style="color:#75715e">  ** This is the structure used to store selection data for
</span><span style="color:#75715e">  ** selections of type &#34;CustomClass&#34;. All callbacks in our
</span><span style="color:#75715e">  ** AVDocSelectionServer can assume that selData is a
</span><span style="color:#75715e">  ** pointer to one of these.
</span><span style="color:#75715e">  */</span>
  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">_t_CustomClassSelection</span>
  {
    PDAnnot annotToScrollTo;<span style="color:#75715e">// the first annot that is highlighted
</span><span style="color:#75715e"></span>    list<span style="color:#f92672">&lt;</span>pageSelection<span style="color:#f92672">&gt;*</span> pageSelectionToHighlight;
    AVDoc currentDoc;
    <span style="color:#66d9ef">bool</span> isAnnotToScrollToSet;
  } CustomClassSelectionRec, <span style="color:#f92672">*</span>CustomClassSelection;

  <span style="color:#75715e">// Pidget selection/highlight methods. These methods are
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// shared between the selection server and the AVTool.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">InitializeCustomClassSelectionServer</span> (<span style="color:#66d9ef">void</span>);
  <span style="color:#75715e">/* SelectionServerGetType
</span><span style="color:#75715e">  ** ------------------------------------------------------
</span><span style="color:#75715e">  ** */</span>
  <span style="color:#75715e">/** We&#39;re registering a selection server of type &#34;CustomClass&#34;.
</span><span style="color:#75715e">  **
</span><span style="color:#75715e">  ** @return the selection server type.
</span><span style="color:#75715e">  ** */</span>
  <span style="color:#66d9ef">static</span> ACCB1 ASAtom ACCB2 <span style="color:#a6e22e">CustomClassSelectionServerGetType</span> ()
  {
    <span style="color:#66d9ef">return</span> ASAtomFromString (<span style="color:#e6db74">&#34;CustomClass&#34;</span>);
  }

  ACCB1 <span style="color:#66d9ef">void</span> ACCB2 <span style="color:#a6e22e">DrawCustomClassSelection</span> (AVPageView pageView, AVDevRect <span style="color:#f92672">*</span>updateRect, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>data);
  <span style="color:#66d9ef">extern</span> ACCB1 <span style="color:#66d9ef">void</span> ACCB2 <span style="color:#a6e22e">SelectionServerLosingSelection</span> (AVDoc doc, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>selData, ASBool highlight);
  <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">MySelectAllProc</span> (AVDoc doc, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span> selData);
  <span style="color:#66d9ef">extern</span> AVDocSelectionSelectAllProc prc;
  <span style="color:#75715e">#endif 
</span><span style="color:#75715e"></span>  
  <span style="color:#75715e">// !SELECTIONSERVER_H
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// ***************Its corresponding realization and helper &#39;drawing utils&#39; file intended to actually draw the selection************
</span><span style="color:#75715e"></span>  <span style="color:#75715e">/*********************************************************************
</span><span style="color:#75715e">  ADOBE SYSTEMS INCORPORATED
</span><span style="color:#75715e">  Copyright (C) 1994-2003 Adobe Systems Incorporated
</span><span style="color:#75715e">  All rights reserved.
</span><span style="color:#75715e">  NOTICE: Adobe permits you to use, modify, and distribute this file
</span><span style="color:#75715e">  in accordance with the terms of the Adobe license agreement
</span><span style="color:#75715e">  accompanying it. If you have received this file from a source other
</span><span style="color:#75715e">  than Adobe, then your use, modification, or distribution of it
</span><span style="color:#75715e">  requires the prior written permission of Adobe.
</span><span style="color:#75715e">  -------------------------------------------------------------------*/</span> 
  <span style="color:#75715e">/**
</span><span style="color:#75715e">  file SelectionServer.cpp
</span><span style="color:#75715e">  - The SelectionServer plug-in implements a selection server to handle
</span><span style="color:#75715e">  pidgets. The pidgets selection tool allows users to select pidgetss by calling
</span><span style="color:#75715e">  AVDocSetSelection() with a selection type of &#34;CustomClass&#34;.
</span><span style="color:#75715e">  This call passes control to the selection server, which proceeds to
</span><span style="color:#75715e">  highlight the pidget.
</span><span style="color:#75715e">  - The selection server functionality is limited to getting, showing, and
</span><span style="color:#75715e">  losing a selection.
</span><span style="color:#75715e">  *********************************************************************/</span>
  <span style="color:#75715e">#ifndef MAC_PLATFORM
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;PIHeaders.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#endif
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;CommonHeaders.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;SelectionServer.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;Page.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>  
  <span style="color:#75715e">/*-------------------------------------------------------
</span><span style="color:#75715e">  Constants/Declarations
</span><span style="color:#75715e">  -------------------------------------------------------*/</span>
  <span style="color:#66d9ef">static</span> ASAtom CustomClass_K;
  <span style="color:#66d9ef">static</span> AVPageViewDrawProc cbDrawCustomClassSelection;
  <span style="color:#66d9ef">static</span> AVDocSelectionServerRec CustomClassSelectionServer;
  <span style="color:#66d9ef">static</span> AVDocSelectionSelectAllProc prc;
  <span style="color:#75715e">/*-------------------------------------------------------
</span><span style="color:#75715e">  AVDocSelectionServer Callbacks
</span><span style="color:#75715e">  -------------------------------------------------------*/</span>
  <span style="color:#75715e">/* SelectionServerGettingSelection
</span><span style="color:#75715e">  ** ------------------------------------------------------
</span><span style="color:#75715e">  ** */</span> 
  <span style="color:#75715e">//** This is the selection server&#39;s callback for when a
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//** selection is registered. 
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//**
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//** @param selData pointer to an CustomClassSelectionRec allocated 
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//** through ASmalloc. The LosingSelection callback will call 
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//** ASfree() on it.
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//**
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//** @see AVAppRegisterForPageViewDrawing
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//** */
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">static</span> ACCB1 <span style="color:#66d9ef">void</span> ACCB2 <span style="color:#a6e22e">SelectionServerGettingSelection</span> (AVDoc doc, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>selData, ASBool highlight)
  {
    ASAtom atm <span style="color:#f92672">=</span> ASAtomFromString(<span style="color:#e6db74">&#34;Authoring&#34;</span>);
    AVDocSelectionServer srvr <span style="color:#f92672">=</span> AVDocGetSelectionServerByType(atm);
    prc <span style="color:#f92672">=</span> srvr<span style="color:#f92672">-&gt;</span>SelectAll;
    srvr<span style="color:#f92672">-&gt;</span>SelectAll <span style="color:#f92672">=</span> ASCallbackCreateProto (AVDocSelectionSelectAllProc, <span style="color:#f92672">&amp;</span>MySelectAllProc);
    
    
    AVPageView pageView <span style="color:#f92672">=</span> AVDocGetPageView(doc);
    CustomClassSelection isel <span style="color:#f92672">=</span> (CustomClassSelection)selData;
    <span style="color:#75715e">// Draw the selection. It will only be drawn if the page
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// holding the selection is being displayed.
</span><span style="color:#75715e"></span>    DrawCustomClassSelection (pageView, NULL, selData);
    <span style="color:#75715e">// Register the AVPageViewDrawProc so we can redraw the selection
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// when the page is updated.
</span><span style="color:#75715e"></span>    AVAppRegisterForPageViewDrawing (cbDrawCustomClassSelection, isel);
  }

  <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">MySelectAllProc</span> (AVDoc doc, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span> selData){
    SelectionServerLosingSelection(AVAppGetActiveDoc(),Page<span style="color:#f92672">::</span>currentSelection,false);
    ASAtom atm <span style="color:#f92672">=</span> ASAtomFromString(<span style="color:#e6db74">&#34;Authoring&#34;</span>);
    AVDocSelectionServer srvr <span style="color:#f92672">=</span> AVDocGetSelectionServerByType(atm);
    srvr<span style="color:#f92672">-&gt;</span>SelectAll <span style="color:#f92672">=</span> prc;
    <span style="color:#66d9ef">return</span> srvr<span style="color:#f92672">-&gt;</span>SelectAll(doc,selData);
  }
  <span style="color:#75715e">/* SelectionServerLosingSelection
</span><span style="color:#75715e">  ** ------------------------------------------------------
</span><span style="color:#75715e">  ** */</span> 
  <span style="color:#75715e">/** This is called whenever we have an active selection
</span><span style="color:#75715e">  ** and the Viewer is attempting to change the selection
</span><span style="color:#75715e">  ** to something else.
</span><span style="color:#75715e">  **
</span><span style="color:#75715e">  ** @see AVDocGetPageView
</span><span style="color:#75715e">  ** @see AVAppUnregisterForPageViewDrawing
</span><span style="color:#75715e">  ** @see PDPageGetNumber
</span><span style="color:#75715e">  ** @see AVPageViewGetFirstVisiblePageNum
</span><span style="color:#75715e">  ** @see AVPageViewGetLastVisiblePageNum
</span><span style="color:#75715e">  ** @see AVPageViewRectToDevice
</span><span style="color:#75715e">  ** @see AVPageViewInvalidateRect
</span><span style="color:#75715e">  ** @see AVPageViewDrawNow
</span><span style="color:#75715e">  ** @see PDPageRelease
</span><span style="color:#75715e">  ** @see ASFree
</span><span style="color:#75715e">  */</span>
  ACCB1 <span style="color:#66d9ef">void</span> ACCB2 <span style="color:#a6e22e">SelectionServerLosingSelection</span> (AVDoc doc, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>selData, ASBool highlight)
  {
    AVPageView pageView <span style="color:#f92672">=</span> AVDocGetPageView(doc);
    CustomClassSelection isel <span style="color:#f92672">=</span> (CustomClassSelection)selData;
    ASAtom atm <span style="color:#f92672">=</span> ASAtomFromString(<span style="color:#e6db74">&#34;Authoring&#34;</span>);
    AVDocSelectionServer srvr <span style="color:#f92672">=</span> AVDocGetSelectionServerByType(atm);
    srvr<span style="color:#f92672">-&gt;</span>SelectAll <span style="color:#f92672">=</span> prc;
    
    <span style="color:#75715e">// Make sure that an exception doesn&#39;t prevent us from
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// releasing the PDPage.
</span><span style="color:#75715e"></span>    DURING
    <span style="color:#75715e">// Unregister the AVPageViewDrawProc; there&#39;s no selection
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// to draw any more.
</span><span style="color:#75715e"></span>    AVAppUnregisterForPageViewDrawing (cbDrawCustomClassSelection);
    
    <span style="color:#66d9ef">for</span>(list<span style="color:#f92672">&lt;</span>pageSelection<span style="color:#f92672">&gt;::</span>iterator i <span style="color:#f92672">=</span> isel<span style="color:#f92672">-&gt;</span>pageSelectionToHighlight<span style="color:#f92672">-&gt;</span>begin(); i <span style="color:#f92672">!=</span> isel<span style="color:#f92672">-&gt;</span>pageSelectionToHighlight<span style="color:#f92672">-&gt;</span>end(); i<span style="color:#f92672">++</span>)
    {
      PageSelection<span style="color:#f92672">*</span> iteratorSel <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>(<span style="color:#f92672">*</span>i);
      ASInt32 pageNum <span style="color:#f92672">=</span> PDPageGetNumber (iteratorSel<span style="color:#f92672">-&gt;</span>first);
      <span style="color:#66d9ef">if</span> ((pageNum <span style="color:#f92672">&gt;=</span> AVPageViewGetFirstVisiblePageNum(pageView)) <span style="color:#f92672">&amp;&amp;</span>
      (pageNum <span style="color:#f92672">&lt;=</span> AVPageViewGetLastVisiblePageNum(pageView)) <span style="color:#f92672">&amp;</span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#ae81ff">03</span><span style="color:#ae81ff">8</span>;<span style="color:#f92672">&amp;</span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#ae81ff">03</span><span style="color:#ae81ff">8</span>; highlight)
      {
        AVDevRect viewRect;
        <span style="color:#66d9ef">for</span>(list<span style="color:#f92672">&lt;</span>asfixedRect<span style="color:#f92672">&gt;::</span>iterator pageRect <span style="color:#f92672">=</span> iteratorSel<span style="color:#f92672">-&gt;</span>second<span style="color:#f92672">-&gt;</span>begin(); pageRect <span style="color:#f92672">!=</span> iteratorSel<span style="color:#f92672">-&gt;</span>second<span style="color:#f92672">-&gt;</span>end();pageRect<span style="color:#f92672">++</span>)
        {
          AVPageViewRectToDevice (pageView, <span style="color:#f92672">&amp;</span>(<span style="color:#f92672">*</span>pageRect), <span style="color:#f92672">&amp;</span>viewRect);
          AVPageViewInvalidateRect (pageView, <span style="color:#f92672">&amp;</span>viewRect);
        }
        AVPageViewDrawNow (pageView);
      }
    }
    
    HANDLER
    END_HANDLER;
    <span style="color:#75715e">// Release the page.
</span><span style="color:#75715e"></span>    
    <span style="color:#66d9ef">for</span>(list<span style="color:#f92672">&lt;</span>pageSelection<span style="color:#f92672">&gt;::</span>iterator i <span style="color:#f92672">=</span> isel<span style="color:#f92672">-&gt;</span>pageSelectionToHighlight<span style="color:#f92672">-&gt;</span>begin(); i <span style="color:#f92672">!=</span> isel<span style="color:#f92672">-&gt;</span>pageSelectionToHighlight<span style="color:#f92672">-&gt;</span>end(); i<span style="color:#f92672">++</span>)
    {
      PDPageRelease (((PageSelection)(<span style="color:#f92672">*</span>i)).first);
    }
    <span style="color:#75715e">// Free the selection data. Note that anyone calling AVDocSetSelection
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// for our selection server must have used ASmalloc to allocate the
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// memory, or this won&#39;t work.
</span><span style="color:#75715e"></span>    ASfree (isel);
  }
  <span style="color:#75715e">/* SelectionServerShowSelection
</span><span style="color:#75715e">  ** ------------------------------------------------------
</span><span style="color:#75715e">  ** */</span> 
  <span style="color:#75715e">/** If the user has strayed to a page different from the
</span><span style="color:#75715e">  / ** selection, this callback will take the user to the
</span><span style="color:#75715e">  ** correct page and scroll the selection into view.
</span><span style="color:#75715e">  **
</span><span style="color:#75715e">  ** @see AVPageViewBeginOperation
</span><span style="color:#75715e">  ** @see AVPageViewGoTo
</span><span style="color:#75715e">  ** @see AVPageViewRectToDevice
</span><span style="color:#75715e">  ** @see AVPageViewScrollToRect
</span><span style="color:#75715e">  ** @see AVPageViewEndOperation
</span><span style="color:#75715e">  **/</span>
  <span style="color:#66d9ef">static</span> ACCB1 <span style="color:#66d9ef">void</span> ACCB2 <span style="color:#a6e22e">SelectionServerShowSelection</span> (AVDoc doc, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>selData)
  {
  <span style="color:#75715e">//currently not used
</span><span style="color:#75715e"></span>  }

  ASBool <span style="color:#a6e22e">SelectionServerKeyDown</span> (AVDoc doc, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span> data, AVKeyCode key, AVFlagBits16 flags){
    <span style="color:#66d9ef">if</span> (key <span style="color:#f92672">==</span> <span style="color:#ae81ff">127</span>) {
      AVDocClearSelection(AVAppGetActiveDoc(),false);
    }
    <span style="color:#66d9ef">return</span> false;
  }
  
  <span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">SelectionServerRemovedFromSelection</span> (AVDoc doc, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span> curData, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span> remData, ASBool highlight)
  {
    <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;
    <span style="color:#66d9ef">return</span> NULL;
  }

  <span style="color:#75715e">/* InitializeSelectionServer
</span><span style="color:#75715e">  ** ------------------------------------------------------
</span><span style="color:#75715e">  ** */</span> 
  <span style="color:#75715e">//** Create and register the selection server for pidgets.
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// **
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// ** @see ASAtomFromString
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// ** @see AVDocRegisterSelectionServer
</span><span style="color:#75715e"></span>  <span style="color:#75715e">// ** */
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">InitializeCustomClassSelectionServer</span> (<span style="color:#66d9ef">void</span>)
  {
    <span style="color:#75715e">// Initialize our supporting globals.
</span><span style="color:#75715e"></span>    CustomClass_K <span style="color:#f92672">=</span> CustomClassSelectionServerGetType();
    cbDrawCustomClassSelection <span style="color:#f92672">=</span> ASCallbackCreateProto (AVPageViewDrawProc, DrawCustomClassSelection);
    <span style="color:#75715e">// Set up the pidget selection server.
</span><span style="color:#75715e"></span>    memset (<span style="color:#f92672">&amp;</span>CustomClassSelectionServer, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(AVDocSelectionServerRec));
    CustomClassSelectionServer.size <span style="color:#f92672">=</span> <span style="color:#66d9ef">sizeof</span>(AVDocSelectionServerRec);
    <span style="color:#75715e">// Currently, we only implement Getting, Losing and Showing selections.
</span><span style="color:#75715e"></span>    CustomClassSelectionServer.GetType <span style="color:#f92672">=</span>
    ASCallbackCreateProto (AVDocSelectionGetTypeProc, <span style="color:#f92672">&amp;</span>CustomClassSelectionServerGetType);
    CustomClassSelectionServer.GettingSelection <span style="color:#f92672">=</span>
    ASCallbackCreateProto (AVDocSelectionGettingSelectionProc, <span style="color:#f92672">&amp;</span>SelectionServerGettingSelection);
    CustomClassSelectionServer.LosingSelection <span style="color:#f92672">=</span>
    ASCallbackCreateProto (AVDocSelectionLosingSelectionProc, <span style="color:#f92672">&amp;</span>SelectionServerLosingSelection);
    CustomClassSelectionServer.ShowSelection <span style="color:#f92672">=</span>
    ASCallbackCreateProto (AVDocSelectionShowSelectionProc, <span style="color:#f92672">&amp;</span>SelectionServerShowSelection);
    CustomClassSelectionServer.KeyDown <span style="color:#f92672">=</span>
    ASCallbackCreateProto (AVDocSelectionKeyDownProc, <span style="color:#f92672">&amp;</span>SelectionServerKeyDown);
    CustomClassSelectionServer.RemovedFromSelection <span style="color:#f92672">=</span>
    ASCallbackCreateProto (AVDocSelectionRemovedFromSelectionProc, <span style="color:#f92672">&amp;</span>SelectionServerRemovedFromSelection);
    AVDocRegisterSelectionServer (<span style="color:#f92672">&amp;</span>CustomClassSelectionServer);
  }
</code></pre></div>  <p>
    // drawing utils implementation
  </p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">/*********************************************************************
</span><span style="color:#75715e">ADOBE SYSTEMS INCORPORATED
</span><span style="color:#75715e">Copyright (C) 1994-2003 Adobe Systems Incorporated
</span><span style="color:#75715e">All rights reserved.
</span><span style="color:#75715e">NOTICE: Adobe permits you to use, modify, and distribute this file
</span><span style="color:#75715e">in accordance with the terms of the Adobe license agreement
</span><span style="color:#75715e">accompanying it. If you have received this file from a source other
</span><span style="color:#75715e">than Adobe, then your use, modification, or distribution of it
</span><span style="color:#75715e">requires the prior written permission of Adobe.
</span><span style="color:#75715e">-------------------------------------------------------------------*/</span> 
<span style="color:#75715e">/**
</span><span style="color:#75715e">file SelectionServerDrawUtils.cpp
</span><span style="color:#75715e">- Implementation to draw the highlight around the selected pidget.
</span><span style="color:#75715e">*********************************************************************/</span>
<span style="color:#75715e">#ifndef MAC_PLATFORM
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;PIHeaders.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e">#endif
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;CommonHeaders.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;SelectionServer.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;Resource.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#75715e">/*-------------------------------------------------------
</span><span style="color:#75715e">Helper Methods
</span><span style="color:#75715e">-------------------------------------------------------*/</span>
<span style="color:#75715e">/* DrawCustomClassSelectionHighlight
</span><span style="color:#75715e">** ------------------------------------------------------
</span><span style="color:#75715e">** */</span> 
<span style="color:#75715e">/** Draws the selection on the pageview. Simply draws a
</span><span style="color:#75715e">** rectangle around the pidget.
</span><span style="color:#75715e">**
</span><span style="color:#75715e">** @see AVPageViewSetColor
</span><span style="color:#75715e">** @see AVPageViewDrawRectOutline
</span><span style="color:#75715e">** */</span>
<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">DrawCustomClassSelectionHighlight</span> (AVPageView pageView, <span style="color:#66d9ef">const</span> AVDevRect <span style="color:#f92672">*</span>selBounds)
{
  PDColorValueRec colorVal;
  <span style="color:#75715e">// Define the color for our selection.
</span><span style="color:#75715e"></span>  colorVal.space <span style="color:#f92672">=</span> PDDeviceRGB ;
  colorVal.value[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> ASInt32ToFixed(<span style="color:#ae81ff">1</span>);
  colorVal.value[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> colorVal.value[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> ASInt32ToFixed(<span style="color:#ae81ff">0</span>);

  <span style="color:#75715e">// Set the drawing color for the pageview.
</span><span style="color:#75715e"></span>  AVPageViewSetColor (pageView, <span style="color:#f92672">&amp;</span>colorVal);
  <span style="color:#75715e">// Draw the highlight.
</span><span style="color:#75715e"></span>  AVPageViewDrawRectOutline(pageView, selBounds, <span style="color:#ae81ff">2</span>, NULL, <span style="color:#ae81ff">0</span>);
}
<span style="color:#75715e">/* DrawCustomClassSelection
</span><span style="color:#75715e">** ------------------------------------------------------
</span><span style="color:#75715e">** */</span> 
<span style="color:#75715e">/** This is the AVPageViewDrawProc that draws the current
</span><span style="color:#75715e">** selection. It is registered whenever the selection server&#39;s
</span><span style="color:#75715e">** GettingSelection callback is called, and unregistered when
</span><span style="color:#75715e">** the LosingSelection callback is called. The callback is
</span><span style="color:#75715e">** created in InitializeSelectionServer().
</span><span style="color:#75715e">**
</span><span style="color:#75715e">** @see AVPageViewGetFirstVisiblePageNum
</span><span style="color:#75715e">** @see AVPageViewGetLastVisiblePageNum
</span><span style="color:#75715e">** @see AVPageViewRectToDevice
</span><span style="color:#75715e">** */</span>
ACCB1 <span style="color:#66d9ef">void</span> ACCB2 <span style="color:#a6e22e">DrawCustomClassSelection</span> (AVPageView pageView, AVDevRect <span style="color:#f92672">*</span>updateRect, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>data)
{

  CustomClassSelection isel <span style="color:#f92672">=</span> (CustomClassSelection)data;
  <span style="color:#66d9ef">for</span>(list<span style="color:#f92672">&lt;</span>pageSelection<span style="color:#f92672">&gt;::</span>iterator i <span style="color:#f92672">=</span> isel<span style="color:#f92672">-&gt;</span>pageSelectionToHighlight<span style="color:#f92672">-&gt;</span>begin(); i <span style="color:#f92672">!=</span> isel<span style="color:#f92672">-&gt;</span>pageSelectionToHighlight<span style="color:#f92672">-&gt;</span>end(); i<span style="color:#f92672">++</span>)
  {
    PageSelection<span style="color:#f92672">*</span> iteratorSel <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>(<span style="color:#f92672">*</span>i);
    <span style="color:#66d9ef">if</span>(AVAppGetActiveDoc() <span style="color:#f92672">!=</span> isel<span style="color:#f92672">-&gt;</span>currentDoc)
    {
      <span style="color:#75715e">//this is not the document we need
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">return</span>;
    }
    ASInt32 pageNum <span style="color:#f92672">=</span> PDPageGetNumber (iteratorSel<span style="color:#f92672">-&gt;</span>first);

    DURING
    <span style="color:#66d9ef">if</span> ((pageNum <span style="color:#f92672">&gt;=</span> AVPageViewGetFirstVisiblePageNum(pageView)) <span style="color:#f92672">&amp;&amp;</span>
    (pageNum <span style="color:#f92672">&lt;=</span> AVPageViewGetLastVisiblePageNum(pageView))<span style="color:#f92672">&amp;</span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#ae81ff">03</span><span style="color:#ae81ff">8</span>;<span style="color:#f92672">&amp;</span><span style="color:#960050;background-color:#1e0010">#</span><span style="color:#ae81ff">03</span><span style="color:#ae81ff">8</span>;(pageNum <span style="color:#f92672">==</span> AVPageViewGetPageNum(pageView)))
    {
      <span style="color:#75715e">// Convert the pidgets&#39;s bounding rect to device space.
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">for</span>(list<span style="color:#f92672">&lt;</span>asfixedRect<span style="color:#f92672">&gt;::</span>iterator pageRect <span style="color:#f92672">=</span> iteratorSel<span style="color:#f92672">-&gt;</span>second<span style="color:#f92672">-&gt;</span>begin(); pageRect <span style="color:#f92672">!=</span> iteratorSel<span style="color:#f92672">-&gt;</span>second<span style="color:#f92672">-&gt;</span>end();pageRect<span style="color:#f92672">++</span>)
      {
        ASFixedRect rect <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>pageRect;
        AVDevRect viewRect;
        AVPageViewRectToDevice (pageView, <span style="color:#f92672">&amp;</span>rect, <span style="color:#f92672">&amp;</span>viewRect);
        DrawCustomClassSelectionHighlight (pageView, <span style="color:#f92672">&amp;</span>viewRect);
      }
    }
    HANDLER
    END_HANDLER
  }
}
</code></pre></div>  <p>
    //we&#8217;ll also need some class to hold the selection class instance
  </p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;CustomClassSelectionServer/SelectionServer.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Page</span><span style="color:#f92672">:</span>
{
    <span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
    Page(Form <span style="color:#f92672">*</span>parent);
    <span style="color:#f92672">~</span>Page();
    <span style="color:#75715e">//other custom code
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">InitSelection</span>();
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SetSelection</span>();
    <span style="color:#66d9ef">static</span> CustomClassSelection currentSelection;
};

<span style="color:#66d9ef">typedef</span> vector<span style="color:#f92672">&lt;</span>page<span style="color:#f92672">&gt;</span> PageVector;

<span style="color:#75715e">//making the selection would be fairly easy:
</span><span style="color:#75715e"></span>Page<span style="color:#f92672">::</span>InitSelection();
<span style="color:#66d9ef">for</span>(every_page)
{
    <span style="color:#66d9ef">if</span>( need_selection )
    {
        <span style="color:#f92672">/</span> <span style="color:#f92672">/</span>add selection rectangle
        pageSlctn.second<span style="color:#f92672">-&gt;</span>push_back(boundingRect);
        <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>currentSelection<span style="color:#f92672">-&gt;</span>isAnnotToScrollToSet)
        {
            currentSelection<span style="color:#f92672">-&gt;</span>annotToScrollTo <span style="color:#f92672">=</span> annot;
            currentSelection<span style="color:#f92672">-&gt;</span>isAnnotToScrollToSet <span style="color:#f92672">=</span> true;
            <span style="color:#75715e">//also add referrence to document to avoid cross document painting
</span><span style="color:#75715e"></span>            currentSelection<span style="color:#f92672">-&gt;</span>currentDoc <span style="color:#f92672">=</span> AVAppGetActiveDoc();
        }


        currentSelection<span style="color:#f92672">-&gt;</span>pageSelectionToHighlight<span style="color:#f92672">-&gt;</span>push_back(pageSlctn);
    }
}

Page<span style="color:#f92672">::</span>SetSelection();
</code></pre></div>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="/tags/c&#43;&#43;/">c&#43;&#43;</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/code/tiff-to-picture-box-in-pdf-plugin-adm-dialog/" data-tooltip="Tiff to Picture box in PDF plugin ADM dialog">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/code/nice-books-to-readoopood-agile-etc/" data-tooltip="Nice books to read[OOP,OOD, Agile etc.]">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.vnomad.com/code/custom-selection-server-in-pdf-plugin/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://blog.vnomad.com/code/custom-selection-server-in-pdf-plugin/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Viktor Halitsyn. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="3">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/code/tiff-to-picture-box-in-pdf-plugin-adm-dialog/" data-tooltip="Tiff to Picture box in PDF plugin ADM dialog">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/code/nice-books-to-readoopood-agile-etc/" data-tooltip="Nice books to read[OOP,OOD, Agile etc.]">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.vnomad.com/code/custom-selection-server-in-pdf-plugin/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://blog.vnomad.com/code/custom-selection-server-in-pdf-plugin/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="3">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fblog.vnomad.com%2Fcode%2Fcustom-selection-server-in-pdf-plugin%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http%3A%2F%2Fblog.vnomad.com%2Fcode%2Fcustom-selection-server-in-pdf-plugin%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/d96a6dd84105118027bb67e3396ba7e4?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Viktor Halitsyn</h4>
    
      <div id="about-card-bio">Came a long way from Ukraine, still so much to go&hellip;</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        software engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Seattle, WA
      </div>
    
  </div>
</div>

    

    
  
    <div id="cover" style="background-image:url('https://s3-us-west-2.amazonaws.com/vnomad-public/blog_infra/wp_back3.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'http:\/\/blog.vnomad.com\/code\/custom-selection-server-in-pdf-plugin\/';
          
            this.page.identifier = '5468346569';
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'vnomad';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

